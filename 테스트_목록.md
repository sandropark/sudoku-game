# 스도쿠 게임 테스트 목록 📋

## 📊 테스트 통계

- **단위 테스트**: 89개 (🔄 리팩토링 완료)
- **UI 테스트**: 39개
- **총 테스트**: 128개

---

## 🔄 **테스트 구조 개선 (2024년)**

**기존**: SudokuViewModelTest.kt (1,367줄, 33개 테스트)  
**개선**: 주제별 5개 파일 + 헬퍼/픽스처 클래스

### 📁 새로운 테스트 구조

#### 🎯 **핵심 테스트 파일**

- **SudokuViewModelCoreTest.kt** (12개) - 기본 기능
- **SudokuViewModelErrorTest.kt** (7개) - 에러 처리
- **SudokuViewModelGameTest.kt** (8개) - 게임 플로우
- **SudokuViewModelNoteTest.kt** (8개) - 노트 기능
- **SudokuViewModelUndoTest.kt** (6개) - Undo/Redo

#### 🛠️ **유틸리티 클래스**

- **helpers/SudokuTestHelper.kt** - 공통 헬퍼 메서드
- **fixtures/SudokuTestFixtures.kt** - 고정 테스트 데이터

---

## 🧪 단위 테스트 (Unit Tests)

### 1. SudokuViewModelCoreTest.kt (12개 테스트) ⭐

| 테스트              | 목적            | 검증 내용                                            |
|------------------|---------------|--------------------------------------------------|
| 초기 상태 설정 테스트     | ViewModel 초기화 | selectedRow/Col = -1, board = 9x9, 에러 상태 = false |
| 셀 선택 테스트         | 셀 선택 기능       | 선택된 셀의 row/col이 올바르게 설정                          |
| 유효한 셀 값 설정 테스트   | 숫자 입력 기능      | 빈 셀에 유효한 값 입력 및 지우기                              |
| 셀 지우기 테스트        | 셀 지우기 기능      | 셀 값이 0으로 변경                                      |
| 초기 셀 확인 테스트      | 초기 셀 식별       | 초기 숫자 셀 vs 빈 셀 구분                                |
| 미선택 상태 값 설정 테스트  | 예외 처리         | 셀 선택 없이 값 설정 시도 시 무시                             |
| ViewModel 상태 일관성 | 상태 관리         | 셀 선택 시 상태 변화 확인                                  |
| 잘못된 셀 선택 테스트     | 경계값 테스트       | 유효한 좌표 범위 확인                                     |
| 초기 상태 검증         | null 체크       | 모든 초기 필드 non-null 확인                             |
| 지우기 기능 종합 테스트    | 통합 테스트        | 값 설정 → 지우기 플로우                                   |
| 동시 작업 테스트        | 동시성           | 빠른 연속 셀 선택/값 설정                                  |

### 2. SudokuViewModelErrorTest.kt (7개 테스트) 🚨

| 테스트           | 목적       | 검증 내용                              |
|---------------|----------|------------------------------------|
| 스도쿠 규칙 위반 테스트 | 규칙 검증    | 같은 행/열/박스에 같은 숫자 → invalidCells 추가 |
| 셀 선택 시 에러 처리  | 에러 상태 관리 | 에러 상태 유지되면서 선택 변경                  |
| 에러 메시지 내용 테스트 | 에러 표시    | 잘못된 값 입력 시 에러 상태 생성                |
| 에러 상태 복구 테스트  | 에러 해결    | 유효한 값으로 에러 상태 해제                   |
| 다양한 에러 시나리오   | 에러 시나리오  | 여러 셀에서 에러 생성/복구                    |
| 디버깅 테스트       | 상태 추적    | 에러 상태 변화 로깅                        |

### 3. SudokuViewModelGameTest.kt (8개 테스트) 🎮

| 테스트               | 목적      | 검증 내용                      |
|-------------------|---------|----------------------------|
| 새 게임 생성 테스트       | 새 게임 기능 | 새로운 퍼즐 생성, 상태 초기화          |
| 게임 해답 보기 테스트      | 해답 기능   | 모든 셀 채워짐, solution과 일치     |
| 보드 초기화 테스트        | 보드 리셋   | 초기 상태로 복원                  |
| 게임 완료 플로우 테스트     | 완료 처리   | 해답 → 완료 → 새 게임 플로우         |
| 보드 클리어/리셋 테스트     | 상태 복원   | 수정 → 클리어 → 원상복구            |
| StateFlow 일관성 테스트 | 상태 동기화  | 상태 변화 일관성 확인               |
| 테스트용 정답 입력 테스트    | 정답 기능   | fillCorrectAnswers() 동작 확인 |

### 4. SudokuViewModelNoteTest.kt (8개 테스트) 📝

| 테스트               | 목적    | 검증 내용                |
|-------------------|-------|----------------------|
| 노트 모드 토글 테스트      | 모드 전환 | 노트 모드 활성화/비활성화       |
| 노트 숫자 추가 테스트      | 노트 입력 | 노트 모드에서 숫자 추가        |
| 노트 숫자 제거 테스트      | 노트 삭제 | 특정 노트 숫자 제거          |
| 초기 셀 변경 불가 테스트    | 보호 기능 | 초기 셀 숫자/노트 변경 불가     |
| 노트 토글 제거 테스트      | 노트 토글 | 같은 숫자 재클릭 시 제거       |
| 비활성화 상태 테스트       | 모드 무시 | 노트 모드 OFF 시 노트 추가 무시 |
| 초기 셀 보호 테스트       | 종합 보호 | 초기 셀에 대한 모든 변경 차단    |
| 노트↔숫자 전환 테스트 (2개) | 상호 전환 | 노트→숫자, 숫자→노트 전환      |

### 5. SudokuViewModelUndoTest.kt (6개 테스트) ↩️

| 테스트            | 목적      | 검증 내용              |
|----------------|---------|--------------------|
| 단일 Undo 테스트    | 기본 되돌리기 | 값 설정 → Undo → 원상복구 |
| 다중 Undo 테스트    | 연속 되돌리기 | 여러 동작 → 순차 Undo    |
| Undo 스택 크기 제한  | 메모리 관리  | 최대 50개 동작만 저장      |
| 선택 상태 복원 테스트   | 상태 복원   | Undo 시 선택 상태도 복원   |
| 새 게임 시 스택 초기화  | 스택 관리   | 새 게임 시 Undo 스택 클리어 |
| 노트 변경 Undo 테스트 | 노트 되돌리기 | 노트 추가/제거도 Undo 가능  |

### 2. SudokuGameTest.kt (12개 테스트)

| 테스트          | 목적       | 검증 내용                       |
|--------------|----------|-----------------------------|
| 초기 게임 생성     | 게임 생성 확인 | 보드 = 9x9, 모든 셀 = 0~9 범위     |
| 셀 값 설정       | 셀 설정 기능  | 빈 셀 + 초기 셀 모두 설정 가능         |
| 유효하지 않은 값 설정 | 범위 검증    | 10 이상, 음수 값 거부, 1~9는 허용     |
| 스도쿠 규칙 검증    | 규칙 검증    | 같은 행/열/박스에 같은 숫자 → false    |
| 게임 완료 상태     | 완료 상태 확인 | 초기 = false, 해답 보기 후 = true  |
| 초기 셀 확인      | 초기 셀 식별  | 초기 숫자 셀 = true, 빈 셀 = false |
| 해답 생성        | 해답 생성 기능 | 모든 셀 채워짐, solution과 일치      |
| 랜덤 퍼즐 생성     | 랜덤성 확인   | 매번 다른 퍼즐 생성, 유효한 스도쿠 규칙     |

### 3. SudokuGameBoundaryTest.kt (8개 테스트)

| 테스트          | 목적      | 검증 내용            |
|--------------|---------|------------------|
| 최소값/최대값      | 경계값 테스트 | 0, 9 설정 성공       |
| 유효하지 않은 값 범위 | 범위 검증   | 10 이상, 음수 거부     |
| 동시 셀 수정      | 동시성 테스트 | 여러 셀 연속 수정 시 일관성 |

### 4. SudokuStateTest.kt (2개 테스트)

| 테스트      | 목적       | 검증 내용                  |
|----------|----------|------------------------|
| 기본 생성자   | 기본 초기화   | 모든 필드 기본값, board = 9x9 |
| 매개변수 생성자 | 매개변수 초기화 | 전달된 모든 값 올바르게 저장       |

### 5. SimpleTest.kt (1개 테스트)

| 테스트      | 목적    | 검증 내용                    |
|----------|-------|--------------------------|
| 간단한 셀 설정 | 기본 기능 | 빈 셀 찾기 → 유효한 값 찾기 → 셀 설정 |

### 6. SudokuIntegrationTest.kt (2개 테스트)

| 테스트        | 목적     | 검증 내용                      |
|------------|--------|----------------------------|
| 기본 동작      | 통합 동작  | ViewModel + Game 간 기본 상호작용 |
| 게임 완료 시나리오 | 전체 플로우 | 해답 보기로 게임 완료 시나리오          |

---

## 📱 UI 테스트 (Android Instrumented Tests)

### SudokuUITest.kt (39개 테스트)

#### 🎯 핵심 기능 테스트 (15개)

| 테스트        | 목적       | 검증 내용                      |
|------------|----------|----------------------------|
| 초기 화면 상태   | UI 요소 표시 | 스도쿠 보드, 숫자 패드, 버튼들 존재      |
| 셀 선택       | 셀 선택 UI  | 셀 클릭 시 선택 상태 표시            |
| 숫자 입력      | 숫자 입력 UI | 셀 선택 → 숫자 버튼 클릭 → 셀에 숫자 표시 |
| 초기 셀 보호    | 초기 셀 수정  | 초기 셀도 숫자 입력 가능 (요구사항)      |
| 유효하지 않은 이동 | 에러 표시 UI | 잘못된 숫자 → 빨간색 텍스트 표시        |
| 셀 지우기      | 지우기 UI   | 지우기 버튼 → 셀 비워짐             |
| 새 게임       | 새 게임 UI  | 새 게임 버튼 → 보드 초기화           |
| 해답 보기      | 해답 보기 UI | 해답 보기 버튼 → 모든 셀 채워짐        |
| 실행취소 버튼    | 되돌리기 UI  | 실행취소 버튼 → 이전 상태 복구         |
| 초기 셀 지우기   | 초기 셀 지우기 | 초기 셀도 지우기 가능 (요구사항)        |

#### 🎨 UI 레이아웃 테스트 (10개)

| 테스트           | 목적       | 검증 내용                |
|---------------|----------|----------------------|
| 숫자 패드 버튼      | 숫자 버튼 표시 | 1~9 버튼 모두 존재, 클릭 가능  |
| 액션 버튼         | 액션 버튼 표시 | 새 게임, 해답 보기 버튼 작동    |
| 게임 완료 UI      | 완료 상태 UI | 해답 보기 후 모든 셀에 1~9 표시 |
| 에러 상태 표시 및 복구 | 에러 UI    | 잘못된 입력 → 빨간색 → 복구    |
| 숫자 패드 행 표시    | 패드 레이아웃  | 숫자 패드 행이 표시됨         |
| 모든 셀 표시       | 보드 레이아웃  | 모든 셀(9x9)이 표시됨       |
| 두꺼운 박스 선      | 박스 구분    | 3x3 박스가 시각적으로 구분됨    |
| 스도쿠 보드 레이아웃   | 보드 구조    | 9x9 그리드, 클릭 가능한 셀들   |
| 보드 크기         | 보드 크기    | 보드가 충분히 크게 표시됨       |

#### ⚡ 성능 및 안정성 테스트 (14개)

| 테스트                    | 목적     | 검증 내용             |
|------------------------|--------|-------------------|
| 빠른 연속 작업               | UI 안정성 | 빠른 연속 셀 선택, 숫자 입력 |
| UI 상태 일관성              | 일관성    | 모든 UI 요소 일관되게 표시  |
| 스도쿠 보드 표시              | 기본 표시  | 보드가 표시됨           |
| 숫자 패드 표시               | 패드 표시  | 숫자 패드가 표시됨        |
| 숫자 버튼 표시               | 버튼 표시  | 숫자 버튼들이 표시됨       |
| 액션 버튼 표시               | 액션 표시  | 액션 버튼들이 표시됨       |
| 에러 메시지 타임아웃            | 에러 처리  | 에러 발생 시 안정적 처리    |
| ViewModel과 UI 초기 셀 일관성 | 일관성    | 초기 셀 처리 일관성       |
| 초기 및 편집 가능 셀 일관성       | 일관성    | 셀 타입별 처리 일관성      |
| 숫자 패드 상호작용             | 상호작용   | 숫자 패드 버튼 클릭       |
| 지우기 버튼 기능              | 지우기 기능 | 지우기 버튼 동작         |
| 지우기 버튼 (선택 없음)         | 예외 처리  | 셀 선택 없이 지우기       |
| 지우기 버튼 여러 번            | 반복 동작  | 여러 번 연속 지우기       |
| 빠른 셀 선택                | 빠른 선택  | 빠른 연속 셀 선택        |

---

## 🎯 요구사항별 테스트 매핑

### ✅ 요구사항 1: "숫자 입력하면 화면에 숫자가 표시되고 틀린 숫자인 경우 빨간색으로 표시된다"

| 테스트                 | 검증 내용             |
|---------------------|-------------------|
| 숫자 입력 테스트           | 숫자가 항상 입력됨        |
| 유효하지 않은 이동 테스트      | invalidCells에 추가됨 |
| 유효하지 않은 이동 테스트 (UI) | 빨간색 텍스트 표시        |
| 초기 셀 보호 테스트         | 초기 셀도 수정 가능       |

### ✅ 요구사항 2: "되돌리기 시 게임판의 상태는 이전 상태로 돌아가야 한다"

| 테스트              | 검증 내용                      |
|------------------|----------------------------|
| 실행취소 테스트         | 보드, 선택 상태, invalidCells 복구 |
| 실행취소 버튼 테스트      | UI에서 이전 상태 복구              |
| testMultipleUndo | 여러 단계 되돌리기                 |

---

## 🔧 테스트 특징

### 🛡️ 안정성 보장

- **동기화 처리**: `advanceUntilIdle()`, `runCurrent()` 사용
- **예외 처리**: 셀 없음, 텍스트 없음 등 안전 처리
- **복구 로직**: 테스트 후 상태 원래대로 복구

### 🎯 검증 방식

- **단위 테스트**: `assertEquals`, `assertTrue` 등 정확한 값 검증
- **UI 테스트**: `assertExists()`, `performClick()` 등 상호작용 검증
- **통합 테스트**: 전체 플로우 상태 일관성 검증

### 📈 테스트 커버리지

- **기능별**: 각 기능 독립적 테스트
- **경계값**: 최소값, 최대값, 유효하지 않은 값
- **에러 시나리오**: 잘못된 입력, 동시 작업
- **UI 상호작용**: 사용자 액션 반응

---

## 🚀 테스트 실행 결과

```
✅ 단위 테스트: 50/50 통과
✅ UI 테스트: 39/39 통과
✅ 전체 테스트: 89/89 통과
``` 